<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Track your Workouts</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.15.0/css/mdb.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        .workout-modal {
            position: absolute;
            top: 20px;
            right: 10px;
        }

        .md-form {
            margin: 0px;
        }
    </style>
</head>
<body>
<div id="workout-app">
    <div class="jumbotron text-center">
        <h1>Workout Tracker</h1>
        <br>
        <h5 class="indigo-text h3 mb-4">Push ups</h5>
        <div class="row">
            <div class="col col-6">
                <table class="table table-striped">
                    <thead class="indigo white-text">
                    <tr>
                        <th>Date</th>
                        <th>Reps</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr v-for="(workout, index) in workouts">
                        <td>
                            <div class="md-form">
                                <input type="text" class="form-control-sm form-control" v-model=workout.date>
                            </div>
                        </td>
                        <td>
                            <div class="md-form">
                                <input type="text" class="form-control-sm form-control" v-model=workout.reps>
                            </div>
                        </td>
                        <td>
                            <div class="md-form">
                            <span class="badge badge-pill indigo" v-on:click="updateWorkouts(workout)">
                                <i aria-hidden="true" class="fas fa-save fa-2x"></i>
                            </span>
                                <span class="badge badge-pill red" v-on:click="deleteWorkout()">
                                <i aria-hidden="true" class="fas fa-trash fa-2x"></i>
                            </span>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                    <tfoot>
                    <tr>
                        <th></th>
                        <th></th>
                        <th>
                            <span class="badge badge-pill indigo" v-on:click="createWorkout()">
                                <i aria-hidden="true" class="fas fa-plus fa-2x"></i>
                            </span>
                        </th>
                    </tr>
                    </tfoot>
                </table>
            </div>
            <div class="col col-6">

            </div>
        </div>


        <h3 v-if="showSuccess" class="workout-modal">
            <span class="badge badge-success">
                <i aria-hidden="true" class="fas fa-check"></i>&nbsp;Workout updated
            </span>
        </h3>
    </div>
</div>
</body>
<script type="text/javascript">
    new Vue({
        el: '#workout-app',
        data: {
            workoutType: '1',
            workouts: [],
            showSuccess: false
        },
        created() {
            this.loadWorkouts()
        },
        methods: {
            loadWorkouts() {
                axios.get('api/workouts/types/' + this.workoutType)
                    .then((workouts) => {
                        this.workouts = workouts.data
                    };)
            },
            createWorkout() {
                const _workout = {id: null, type: this.workoutType, date: new Date().toISOString().slice(0, 10)};
                axios.post('api/workouts/', _workout)
                    .then(() => {
                        this.loadWorkouts()
                    };)
            },
            updateWorkouts(workout) {
                axios.put('api/workouts/' + workout.id, workout)
                    .then(() => {
                        this.showSuccessMsg()
                    };)
            },
            deleteWorkout() {

            },
            showSuccessMsg() {
                this.showSuccess = true;
                setTimeout(() => {
                    this.showSuccess = false
                }, 5000;
            )
            }
        }
    })
</script>